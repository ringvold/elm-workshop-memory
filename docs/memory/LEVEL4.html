
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <title>Level 4 Â· HonKit</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="HonKit 3.7.1">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="LEVEL5.html" />
    
    
    <link rel="prev" href="LEVEL3.html" />
    

    </head>
    <body>
        
<div class="book honkit-cloak">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        <li class="header">Elm arcade</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">1. Memory</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="LEVEL1.html">
            
                <a href="LEVEL1.html">
            
                    
                    Level 1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="LEVEL2.html">
            
                <a href="LEVEL2.html">
            
                    
                    Level 2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="LEVEL3.html">
            
                <a href="LEVEL3.html">
            
                    
                    Level 3
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="2.4" data-path="LEVEL4.html">
            
                <a href="LEVEL4.html">
            
                    
                    Level 4
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="LEVEL5.html">
            
                <a href="LEVEL5.html">
            
                    
                    Level 5
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="TEA.html">
            
                <a href="TEA.html">
            
                    
                    The Elm Architecture
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.7" data-path="BONUS.html">
            
                <a href="BONUS.html">
            
                    
                    Bonus level
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">2. Snake</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../snake/">
            
                <a href="../snake/">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="../snake/LEVEL1.html">
            
                <a href="../snake/LEVEL1.html">
            
                    
                    Level 1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="../snake/LEVEL2.html">
            
                <a href="../snake/LEVEL2.html">
            
                    
                    Level 2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="../snake/LEVEL3.html">
            
                <a href="../snake/LEVEL3.html">
            
                    
                    Level 3
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">3. Minesweeper</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../minesweeper/">
            
                <a href="../minesweeper/">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="../minesweeper/LEVEL1.html">
            
                <a href="../minesweeper/LEVEL1.html">
            
                    
                    Level 1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="../minesweeper/LEVEL2.html">
            
                <a href="../minesweeper/LEVEL2.html">
            
                    
                    Level 2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="../minesweeper/LEVEL3.html">
            
                <a href="../minesweeper/LEVEL3.html">
            
                    
                    Level 3
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="../minesweeper/LEVEL4.html">
            
                <a href="../minesweeper/LEVEL4.html">
            
                    
                    Level 4
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.6" data-path="../minesweeper/END.html">
            
                <a href="../minesweeper/END.html">
            
                    
                    The end
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://github.com/honkit/honkit" target="blank" class="gitbook-link">
            Published with HonKit
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Level 4</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="level-4---the-game">Level 4 - The game!</h2>
<p>In memory, as you may know, the player opens two cards, one after another, and if they match they stay open.
If they do not match, both cards are closed again.
This repeats until all cards on the board are open. Before we start implementing the game logic, let&apos;s clean up a bit.</p>
<h3 id="41-housekeeping-part-one">4.1 Housekeeping part one</h3>
<p>Our deck of cards is a list of <code>Card</code>s and we will be passing them around in our program.
Therefore, instead of having to write <code>List Card</code> everywhere, we want to be able to write <code>Deck</code>.</p>
<p>Also, in the game we will be matching pairs of cards with each other, and will need some way to distinguish between two cards with the same image.
We will do this by saying that a card can be <em>either</em> in group <code>A</code> or in group <code>B</code>. Use a custom type to achieve this, and add it as a field in our <code>Card</code> type.
With this we can check if two cards are of one pair by comparing their <code>id</code> and <code>group</code> fields!</p>
<hr>
<p><strong>Task:</strong></p>
<ul>
<li>Create a type alias for our deck of cards.</li>
<li>Create a custom type for representing the group of a card.</li>
<li>Add <code>group</code> as a field in our <code>Card</code> type</li>
</ul>
<h3 id="42-housekeeping-part-two">4.2 Housekeeping part two</h3>
<p>By now our <code>Main.elm</code> file is getting quite big, so we should probably do something about that.
It is common in Elm projects to have the application&apos;s model and associated types in their own file(s), so let&apos;s try that.</p>
<hr>
<p><strong>Task:</strong></p>
<ol>
<li>Move all types and type aliases to the file <code>Model.elm</code><ul>
<li>See <a href="#note-on-modules">Note on modules</a> below</li>
</ul>
</li>
<li>To use our types in <code>Main.elm</code> we also need to import them. This is done in the same way as we import the <code>Html</code> module (<code>import Html exposing (..)</code>)</li>
</ol>
<p>In addition to this, let&apos;s pretend we&apos;re famous TV chefs and cheat a little bit. We have prepared a module <code>DeckGenerator</code> that can be used to generate a deck of cards.
Use this by importing <code>DeckGenerator</code> in <code>Main.elm</code> and using the <code>DeckGenerator.static</code> value as <code>model</code>&apos;s initial value.</p>
<blockquote>
<h3 id="note-on-modules">Note on modules</h3>
<p>A module&apos;s name must match its filename.
For example:</p>
<ul>
<li>Filename: <code>GameLogic.elm</code> -&gt; module name: <code>GameLogic</code></li>
<li>Filename: <code>Models/User.elm</code> -&gt; module: <code>Models.User</code></li>
</ul>
<p>You must also be explicit with what your module exposes to the public by listing them along with the module declaration.
For type aliases and functions you just list their names, but for custom types you have two choices:</p>
<ul>
<li>exposing <em>only the type</em> (often called opaque types)</li>
<li>exposing both the type and its constructors.</li>
</ul>
<p>When exposing only the type you list its name, but when you expose its constructors too you add <code>(..)</code> after the type name.</p>
<p>Example:</p>
<pre><code class="lang-elm"><span class="hljs-keyword">module</span> MyModule <span class="hljs-keyword">exposing</span> (<span class="hljs-type">MyTypeAlias</span>, myFunction, <span class="hljs-type">MyCustomType</span>(..), <span class="hljs-type">MyOpaqueCustomType</span>)

<span class="hljs-keyword">type</span> <span class="hljs-keyword">alias</span> <span class="hljs-type">MyTypeAlias</span> = { name : <span class="hljs-type">String</span> }

<span class="hljs-title">myFunction</span> : <span class="hljs-type">Int</span> -&gt; <span class="hljs-type">Int</span>
<span class="hljs-title">myFunction</span> number
  = number * <span class="hljs-number">2</span>

<span class="hljs-keyword">type</span> <span class="hljs-type">MyCustomType</span>
  = <span class="hljs-type">Foo</span>
  | <span class="hljs-type">Bar</span> <span class="hljs-type">Int</span>

<span class="hljs-keyword">type</span> <span class="hljs-type">MyOpaqueCustomType</span>
  = <span class="hljs-type">MyOpaqueCustomType</span> { name : <span class="hljs-type">String</span> }
</code></pre>
</blockquote>
<h3 id="43-game-logic">4.3 Game logic!</h3>
<p>Our game implementation will have three states:</p>
<ol>
<li><code>Choosing</code> - the player chooses the first card</li>
<li><code>Matching</code> - the player chooses the second card to match with the first</li>
<li><code>GameOver</code> - all cards are matched and the player has won</li>
</ol>
<p>The game logic will flow like this:</p>
<ol>
<li>When the player chooses the first card he is in the <code>Choosing</code> state:<ol>
<li>Set all unmatched cards to <code>Closed</code></li>
<li>Set the chosen/clicked card to <code>Open</code></li>
<li>Go to <code>Matching</code> state</li>
</ol>
</li>
<li>In the <code>Matching</code> state, the player chooses his second card:<ol>
<li>If it matches the first card, then set the two cards to <code>Matched</code>. If the two cards do not match, set the clicked card to <code>Open</code>.</li>
</ol>
</li>
<li>If all cards are <code>Matched</code>, then go to <code>GameOver</code> state, else go to <code>Choosing</code> state</li>
</ol>
<p>The <code>Model</code> of our program should now change from consisting of just a <code>Deck</code> to being a <code>GameState</code>.
We also need a function that can handle the three different <code>GameState</code>s.
It should have the signature <code>updateCardClick : Card -&gt; GameState -&gt; GameState</code>.</p>
<hr>
<p><strong>Task:</strong></p>
<ul>
<li>Implement the three game states as a custom type called <code>GameState</code></li>
<li>Implement the <code>updateCardClick : Card -&gt; GameState -&gt; GameState</code> function</li>
<li>Update your <code>update</code> and <code>view</code> functions to accommodate for the new shape of our model</li>
<li>Now take a minute and pat yourself on the back for making an awesome game in Elm!</li>
</ul>
<p><strong>Hint:</strong></p>
<p>The <code>GameOver</code> state does not need any extra data, but <code>Choosing</code> needs a <code>Deck</code> (the deck we are choosing from), and <code>Matching</code> needs both a <code>Card</code> (the card we are trying to match with) and a <code>Deck</code> (the deck we are choosing from).</p>
<p>When implementing <code>updateCardClick</code> there are a couple of things that will help:</p>
<ol>
<li>You can create a function <code>closeUnmatched : Deck -&gt; Deck</code> that, as its name implies, sets all cards that are not <code>Matched</code> to <code>Closed</code></li>
<li>You can use the built-in function <code>List.all : (a -&gt; Bool) -&gt; List a -&gt; Bool</code> to check if all cards are are matched</li>
<li>The <code>setCardState : CardState -&gt; Card -&gt; Card</code> can be changed to operate on a <code>Deck</code> instead; <code>setCardState : CardState -&gt; Card -&gt; Deck -&gt; Deck</code>. This will fit nicely with using Elm&apos;s &quot;pipe operator&quot;</li>
<li>The &quot;pipe operator&quot; (<a href="http://package.elm-lang.org/packages/elm-lang/core/latest/Basics#|" target="_blank"><code>|&gt;</code></a>) is great when you have multiple functions that all depend on the result of the previous function.
For example:</li>
</ol>
<pre><code class="lang-elm"><span class="hljs-title">myString</span> =
    <span class="hljs-type">String</span>.toUpper (<span class="hljs-type">String</span>.repeat <span class="hljs-number">2</span> (<span class="hljs-type">String</span>.reverse <span class="hljs-string">&quot;olleh&quot;</span>))
<span class="hljs-comment">-- myString == &quot;HELLOHELLO&quot;</span>
</code></pre>
<p>can be written as</p>
<pre><code class="lang-elm"><span class="hljs-title">myString</span> =
    <span class="hljs-string">&quot;olleh&quot;</span>
        |&gt; <span class="hljs-type">String</span>.reverse
        |&gt; <span class="hljs-type">String</span>.repeat <span class="hljs-number">2</span>
        |&gt; <span class="hljs-type">String</span>.toUpper
<span class="hljs-comment">-- myString == &quot;HELLOHELLO&quot;</span>
</code></pre>
<p>In short: <code>myFunction myArgument == myArgument |&gt; myFunction</code>.
This will prove useful with the updated <code>setCardState</code> function.</p>
<ol>
<li>&quot;Let expressions&quot; is a way of storing intermediate values (kind of like variables).
The above example can also be written as:</li>
</ol>
<pre><code class="lang-elm"><span class="hljs-title">myString</span> =
    <span class="hljs-keyword">let</span>
        reversed = <span class="hljs-type">String</span>.reverse <span class="hljs-string">&quot;olleh&quot;</span>
        repeated = <span class="hljs-type">String</span>.repeat <span class="hljs-number">2</span> reversed
    <span class="hljs-keyword">in</span>
    <span class="hljs-type">String</span>.toUpper repeated
<span class="hljs-comment">-- myString == &quot;HELLOHELLO&quot;</span>
</code></pre>
<p>It&apos;s a way of saying &quot;<strong><em>Let</em></strong> <code>reversed</code> and <code>repeated</code> be defined <strong><em>in</em></strong> the following expression but nowhere else&quot;.</p>
<blockquote>
<h4 id="optional">Optional:</h4>
<p>Refreshing the page every time you want to play another game is boring, so try to add a &quot;restart game&quot; button in the &quot;Game over&quot; view. Hint: it is common to have a top-level value called <code>init</code> that contains the initial state of the <code>model</code>.</p>
</blockquote>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="LEVEL3.html" class="navigation navigation-prev " aria-label="Previous page: Level 3">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="LEVEL5.html" class="navigation navigation-next " aria-label="Next page: Level 5">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Level 4","level":"2.4","depth":1,"next":{"title":"Level 5","level":"2.5","depth":1,"path":"memory/LEVEL5.md","ref":"memory/LEVEL5.md","articles":[]},"previous":{"title":"Level 3","level":"2.3","depth":1,"path":"memory/LEVEL3.md","ref":"memory/LEVEL3.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56},"embedFonts":false},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"memory/LEVEL4.md","mtime":"2022-07-12T19:54:57.019Z","type":"markdown"},"gitbook":{"version":"3.7.1","time":"2022-07-12T20:17:05.425Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <noscript>
        <style>
            .honkit-cloak {
                display: block !important;
            }
        </style>
    </noscript>
    <script>
        // Restore sidebar state as critical path for prevent layout shift
        function __init__getSidebarState(defaultValue){
            var baseKey = "";
            var key = baseKey + ":sidebar";
            try {
                var value = localStorage[key];
                if (value === undefined) {
                    return defaultValue;
                }
                var parsed = JSON.parse(value);
                return parsed == null ? defaultValue : parsed;
            } catch (e) {
                return defaultValue;
            }
        }
        function __init__restoreLastSidebarState() {
            var isMobile = window.matchMedia("(max-width: 600px)").matches;
            if (isMobile) {
                // Init last state if not mobile
                return;
            }
            var sidebarState = __init__getSidebarState(true);
            var book = document.querySelector(".book");
            // Show sidebar if it enabled
            if (sidebarState && book) {
                book.classList.add("without-animation", "with-summary");
            }
        }

        try {
            __init__restoreLastSidebarState();
        } finally {
            var book = document.querySelector(".book");
            book.classList.remove("honkit-cloak");
        }
    </script>
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

